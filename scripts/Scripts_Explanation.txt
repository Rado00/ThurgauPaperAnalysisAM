
FLOW OF THURGAU ANALYSIS SCRIPTS
-----------------------------------------



01_microcensus_population_filter.py (1 TIME FOR SHP)
-----------------------------------------
IN --> 	microzensus/zielpersonen.csv , microzensus/haushalte.csv
		process and merge
OUT --> microzensus/all_population.csv
Pinstrip&000

02_microcensus_trips_filter.py (1 TIME FOR SHP)
-----------------------------------------
IN --> 	microcensus/wege.csv , microcensus/etappen.csv, all_population.csv
		process and divide mic trips based on agents' plan
OUT -->:
		microcensus/row_trips.csv (all trips)
		microcensus/trips_inside_O_and_D_Mic.csv
		microcensus/trips_inside_O_or_D_Mic.csv
		microcensus/population_all_activities_inside_Mic.csv  (3337)
		microcensus/population_at_least_one_activity_inside_Mic.csv (4.757)
		microcensus/trips_all_activities_inside_Mic.csv (12.769)
		microcensus/trips_at_least_one_activity_inside_Mic.csv (18.532)
		3 plots in the plots/ folder
	
CanDo: add filter based on home (commented code)



03_synPop_and_sim_create_csv_files.py (SynPop CSVs only 1 TIME FOR SHP - to be commented)
-----------------------------------------
IN --> 	output_households.xml.gz , output_plans.xml.gz
		SynPop/households.xml.gz , SynPop/population.xml.gz
		no filters
OUT -->:
		0_PreProcess_CSVs_SyntheticAndOutputs\100pct\df_activity_sim.csv
		
        ...\df_activity_synt.csv
        ...\df_legs_synt.csv
        ...\df_persons_synt.csv
        ...\df_routes_synt.csv
        ...\df_households_synt.csv
		

04_synPop_sim_trips.py (1h)(Home population and trips commented because now not necessary)
-----------------------------------------
8 minuti adesso (senza synt e home)
20 min 15/10/25

IN --> "sim"\output_trips.csv, output_persons.csv.gz
		WE CHECKED output_plans.persons and output_persons and they are both 398.245 of which 22999 are trucks
		different trips filters 
OUT -->:
		0_PreProcess_CSVs_SyntheticAndOutputs\100pct\trips_inside_O_and_D_sim.csv
		...\trips_inside_O_or_D_sim.csv
		...\population_all_activities_inside_sim.csv
		...\population_at_least_one_activity_inside_sim.csv
		...\trips_at_least_one_activity_inside_sim.csv
		...\trips_all_activities_inside_sim.csv
		**cmntd** ...\population_home_inside_sim.csv
		**cmntd** ...\trips_population_home_inside_sim.csv

		

05_generate_clean_csv_files.py
-----------------------------------------
Ensures persons with only one "Home" activity are handled properly.

IN-->:
		0_PreProcess_CSVs_SyntheticAndOutputs\100pct\df_activity_sim.csv
		...\df_legs_sim.csv
		...\df_persons_sim.csv
		...\df_routes_sim.csv
		
		...\df_activity_synt.csv (SynPop CSVs only 1 TIME FOR SHP - to be commented)
        ...\df_legs_synt.csv
        ...\df_persons_synt.csv
        ...\df_routes_synt.csv
        ...\df_households_synt.csv
		

		microcensus/population_at_least_one_activities_inside_Mic.csv
		microcensus/population_all_activities_inside_Mic.csv
		microcensus/trips_all_activities_inside_Mic.csv
		microcensus/trips_at_least_one_activities_inside_Mic.csv
		microcensus\df_population_mic
		microcensus\df_trips_mic.
		
		0_PreProcess_CSVs_SyntheticAndOutputs\population_all_activities_inside_sim.csv
		0_PreProcess_CSVs_SyntheticAndOutputs\population_at_least_one_activity_inside_sim.csv
		0_PreProcess_CSVs_SyntheticAndOutputs\trips_at_least_one_activity_inside_sim.csv
		0_PreProcess_CSVs_SyntheticAndOutputs\trips_all_activities_inside_sim.csv

processes various things
create_activity_chain_mic(group) and create_activity_chain_syn(group):
Create activity chain summaries from trip/activity sequences.

OUT-->:
		1_Cleaned_CSVs\trips_mic.csv
		1_Cleaned_CSVs\activity_chains_sim.csv
		1_Cleaned_CSVs\activity_chains_mic.csv
		1_Cleaned_CSVs\population_clean_mic.csv
		1_Cleaned_CSVs\population_clean_sim.csv	
		1_Cleaned_CSVs\legs_clean_sim.csv
		
		1_Cleaned_CSVs\trips_at_least_one_activity_inside_sim.csv
		1_Cleaned_CSVs\trips_all_activities_inside_sim.csv
		
		1_Cleaned_CSVs\trips_synt.csv
		1_Cleaned_CSVs\activity_chains_syn.csv
		1_Cleaned_CSVs\population_clean_synth.csv
		1_Cleaned_CSVs\legs_clean_synt.csv

(Commented out: synthetic population outputs)



06_synt_and_sim_mode_share_by_time_distance.py
-----------------------------------------
7 min
2. Define Helper Function
	compute_avg_coordinates(start_link, end_link, link_data):
	Takes the coordinates of a start and end link from a dictionary.
	Calculates the average X and Y coordinate between start and end link (for midpoint mapping).

IN-->:
		output_plans.xml.gz
		working with population.xml.gz (COMMENTED AFTER 1ST)

	Extracts:
		legs (movements)
		routes (travel paths)
		activities (activities at locations)

5. Prepare Link Coordinates
	Builds a dictionary (link_dict_sim_str) mapping each link ID to its (X, Y) coordinates.
	This is used later to assign spatial coordinates to each trip.

Adds average coordinates (X, Y) between start and end links for each trip.

OUT-->:
		travel_time_distance_mode_sim.csv
		travel_time_distance_mode_synt.csv



07_plot_mode_share.py
--------------------------------------------
IN -->:
	trips_all_activities_inside_mic.csv
	trips_all_activities_inside_sim.csv	
	travel_time_distance_mode_synt.csv (if read_SynPop )
	
OUT -->: 
		ThurgauPaperAnalysisAM\plots\simNumber\Mode_shares_distance.csv		includes STD and AV
		Mode_shares_by_trip.csv
		Mode_shares_time.csv
		Mode_share_by_Distance.png
		Mode_share_by_Trips.png



08_plot_mode_share_time_distance_synt.py
-----------------------------------------

		
		






09_plot_smaller_zones_modal_split.py
-----------------------------------------

IN-->:
		travel_time_distance_mode_synt.csv
		travel_time_distance_mode_sim.csv

	Removes unwanted modes like truck and outside.
	Filters the synthetic and simulated trips that fall within that zone.

OUT-->:
		Distance share plot.
		Travel time share plot.
		Trip number share plot.
		Saves detailed CSVs comparing synthetic and simulated mode shares.
		arcgis_pro_dict.json for further spatial analysis or mapping in ArcGIS Pro.



10_plot_the_clean_csv_files.py
-----------------------------------------
IN-->:
		trips_mic.csv, trips_synt.csv)
		Activity chains (activity_chains_syn.csv, activity_chains_sim.csv, activity_chains_mic.csv)
		Population (population_clean_mic.csv, population_clean_synth.csv, population_clean_sim.csv)
		Legs (legs_clean_synt.csv, legs_clean_sim.csv)
		Households (df_households_synt.csv)
		Activities (df_activity_synt.csv, df_activity_sim.csv)

		
OUT-->:		
		The script creates multiple comparison plots:	
		Pie charts comparing gender distribution between:
		Bar plots comparing household income classes between microcensus and synthetic households:
		Bar plots Car Ownership
		Bar plots comparing:
			Activity types (synthetic population)
			Trip purposes (microcensus)
			Age Distribution
		Bar plots comparing:
			Departure times of trips
			Arrival times of trips
			Activity Chains

		mode_share_trip_comparison.csv
		

11_CSVs_in_a_column.py
-----------------------------------------
IN-->:
		mode_share_trip_comparison.csv
		Mode_share_distance_comparison.csv
		Mode_share_time_comparison.csv

mode_mappings, ,to. , organises in a single CSV

OUT-->:
		mode_share_directory\modalSplitCalibration.csv



10_DRT_Data_Analysis.py
-----------------------------------------
Will include DRT analysis


11_CSVs_in_a_column.py
-------------------------------------------


12_DRT_Data_Analysis.py
---------------------------------------------

13_DRT_Order_Ouputs.py
---------------------------------------------

14_compare_outputs.py
--------------------------------------------

IN-->:
		sim1folder\output_trip.csv.gz
		sim2folder\output_trip.csv.gz


OUT-->:
		ThurgauPaperAnalysisAM\plots\compare_simulations

